# 1 计数器固定窗口算法

- 优点：实现简单，容易理解
- 缺点：流量曲线可能不够平滑，有“突刺现象”，一段时间内（不超过时间窗口）系统服务不可用。比如窗口大小为1s，限流大小为100，然后恰好在某个窗口的第1ms来了100个请求，然后第2ms-999ms的请求就都会被拒绝，这段时间用户会感觉系统服务不可用。窗口切换时可能会产生两倍于阈值流量的请求。比如窗口大小为1s，限流大小为100，然后恰好在某个窗口的第999ms来了100个请求，窗口前期没有请求，所以这100个请求都会通过。再恰好，下一个窗口的第1ms有来了100个请求，也全部通过了，那也就是在2ms之内通过了200个请求，而我们设定的阈值是100，通过的请求达到了阈值的两倍

# 2 计数器滑动窗口算法

避免了计数器固定窗口算法固定窗口切换时可能会产生两倍于阈值流量请求的问题，和漏斗算法相比，新来的请求也能够被处理到，避免了漏斗算法的饥饿问题

# 3 漏斗算法

上面两种窗口算法没有做到平滑流量。而漏斗算法做到了平滑流量。请求来了之后会首先进到漏斗里，然后漏斗以恒定的速率将请求流出进行处理，从而起到平滑流量的作用。当请求的流量过大时，漏斗达到最大容量时会溢出，此时请求被丢弃。缺点是不能解决流量突发问题，因为处理速率是固定的

# 4 令牌桶算法

令牌桶算法是对漏斗算法的一种改进，除了能够起到限流的作用外，还允许一定程度的流量突发。主要原理就是以固定的速率往桶里面放令牌，请求到来的时候先请求令牌


参考

https://juejin.cn/post/6870396751178629127
