# 接口访问变慢，怎么排查

这个问题本质上就是“浏览器输入URL全过程”的变形，但是这个问题包含更多的东西。

先定位出性能瓶颈。

答：
  第一步：从客户端到服务端的网络层面的分析。分析网络延迟和丢包，检查网络连接的基本健康状况，包括延迟和丢包率。如果存在高延迟或丢包，问题可能在于网络本身，影响TCP连接。判断客户端到服务器的网络是否顺畅，包括 DNS 解析、TCP/IP 连接。捕获和分析TCP层的数据包。查看TCP三次握手、四次挥手过程，以及是否有大量重传或超时发生。如果TCP连接建立过程缓慢，或存在大量的重传和超时，问题可能在于TCP层。查看服务器的网络带宽和网卡使用率，因为有可能流量突增，达到了硬件的上限。总之第一步就是确认是不是网络的问题导致。例如你上GitHub很慢，但是上百度很快，这就是网络问题。再比如你的服务器被DDos攻击，网络带宽都被占用完了，服务器就访问不到了。
（补充分析工具和方法提及具体的分析工具：在实际操作中，提及你会使用哪些具体工具进行诊断，如ping、traceroute、tcpdump、Wireshark等，会让你的回答更加具体和专业。日志分析：提及检查服务器和网络设备的日志，可以帮助发现问题的时间点和可能的原因。）

  第二步：如果网络层面没有问题，接下来就确认应用层面了，后端现在一般是微服务了，哪怕不是微服务，也可能存在服务调用第三方接口的场景，查看接口调用日志中的耗时，先定位具体是哪个服务造成的缓慢，确认这个问题是间歇性的问题还是一直存在的问题。查看日志是否有报错。查看服务 CPU 使用率、查看内存使用率，查看数据库慢查询日志。
  
  如果是间歇性存在的问题：则看是否使用了缓存，有可能存在缓存击穿、缓存雪崩的问题
  
  如果是一直存在的问题：看是否使用了缓存，可能存在缓存穿透的问题，查看数据库是否有慢查询日志，监控 JVM 运行状态，查看是否有死循环、是否频繁地垃圾回收
